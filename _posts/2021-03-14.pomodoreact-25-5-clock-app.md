---
slug: "pomodoreact-25-5-clock-app"
title: "PomodoReact - Creating a Simple 25 + 5 Clock App Using TypeScript & React"
date: "2021-03-14T23:11:11.399Z"
---

![PomodoReact App](/images/pomodoreact.png) In this post, we will create a simple Pomodoro style 25 + 5 Clock app using TypeScript and React.

## Contents

- [Setup](#setup)
  - [Add Dependencies](#add-dependencies)
- [Components](#components)
  - [Time Adjuster](#time-adjuster)
  - [Clock](#clock)
  - [Controls](#controls)
- [Styles](#styles)
- [Utilities](#utilities)
- [App Class](#app-class)
- [Conclusion](#conclusion)

## Setup

We'll begin with using Create React App to generate all the initial code for us.

```zsh
npx create-react-app pomodoreact
```

### Add Dependencies

We'll be using Sass in this project. One of the easiest ways to get that working is install node-sass.

```zsh
yarn add node-sass
```

Now for development dependencies. Mostly TypeScript and related type declarations.

```zsh
yarn add --dev typescript @types/react @types/react-dom @types/node
```

## Components

### Time Adjuster

```typescript
// src/components/TimeAdjuster.tsx

import React from "react";

interface TimeAdjusterProps {
  type: string;
  length: number;
  onChange: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;
}

export default function TimeAdjuster(props: TimeAdjusterProps): JSX.Element {
  let { type, length, onChange } = props;
  return (
    <div className="TimeAdjuster">
      <h2 id={`${type.toLowerCase()}-label`}>{type} Length</h2>

      <div className="control-group">
        <button
          id={`${type.toLowerCase()}-decrement`}
          className="btn"
          onClick={onChange}
          value="-"
        >
          <i className="fas fa-arrow-down"></i>
        </button>

        <div id={`${type.toLowerCase()}-length`}>{length}</div>

        <button
          id={`${type.toLowerCase()}-increment`}
          className="btn"
          onClick={onChange}
          value="+"
        >
          <i className="fas fa-arrow-up"></i>
        </button>
      </div>
    </div>
  );
}
```

### Clock

```typescript
// src/components/Clock.tsx

interface ClockProps {
  type: string;
  time: number;
  style: { color: string };
}

export default function Clock(props: ClockProps): JSX.Element {
  let { type, time, style } = props;
  let minutes: number = Math.floor(time / 60);
  let seconds: number = Math.floor((time / 60 - minutes) * 60);
  let minutesStr: string;
  let secondsStr: string;

  if (seconds < 10) {
    secondsStr = "0" + seconds.toString();
  } else {
    secondsStr = "" + seconds.toString();
  }

  if (minutes < 10) {
    minutesStr = "0" + minutes.toString();
  } else {
    minutesStr = "" + minutes.toString();
  }

  return (
    <div className="Clock">
      <h2 id="timer-label">{type}</h2>
      <div id="time-left" style={style}>{`${minutesStr}:${secondsStr}`}</div>
    </div>
  );
}
```

### Controls

```typescript
// src/components/Controls.tsx

interface ControlsProps {
  isCounting: boolean;
  onPlayPause: () => void;
  onReset: () => void;
}

export default function Controls(props: ControlsProps): JSX.Element {
  let { isCounting, onPlayPause, onReset } = props;
  return (
    <div className="controls">
      <button id="start_stop" className="btn" onClick={onPlayPause}>
        {isCounting ? (
          <i className="fas fa-pause"></i>
        ) : (
          <i className="fas fa-play"></i>
        )}
      </button>
      <button id="reset" className="btn" onClick={onReset}>
        <i className="fas fa-redo"></i>
      </button>
    </div>
  );
}
```

## Styles

```scss
/* src/index.scss */

@import url("https://fonts.googleapis.com/css2?family=Roboto&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap");
@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");

/* Palette generated by Material Palette - materialpalette.com/blue-grey/light-green */
$primary-color-dark: #455a64;
$primary-color: #607d8b;
$primary-color-light: #cfd8dc;
$primary-color-text: #ffffff;
$accent-color: #8bc34a;
$primary-text-color: #212121;
$secondary-text-color: #757575;
$divider-color: #bdbdbd;

html,
body {
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0;
}

body {
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: "Roboto", sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: $primary-color;
}

.App {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: $primary-color-text;

  .App-title {
    font-size: 3em;
  }

  .settings {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;

    .TimeAdjuster {
      padding: 24px;

      .break-label,
      .session-label {
        font-size: 2em;
      }

      .control-group {
        display: flex;
        justify-content: space-between;
        align-items: center;

        #break-length,
        #session-length {
          font-size: 2em;
        }
      }
    }
  }

  #clock-container {
    margin-top: 8px;

    .Clock {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;

      #timer-label {
        margin: 8px;
      }

      #time-left {
        font-size: 4em;
        font-family: "Roboto Mono", monospace;
      }
    }

    .controls {
      display: flex;
      padding: 24px 0;
      justify-content: space-around;
      align-items: center;
    }
  }
}

.btn {
  background-color: $accent-color;
  color: $primary-color-text;
  border: none;
  font-size: 1.2em;
  padding: 12px;
  border-radius: 10px;
  cursor: pointer;
}
```

## Utilities

```typescript
// src/lib/index.ts

// https://gist.github.com/AlexJWayne/1d99b3cd81d610ac7351
export const accurateInterval = function (
  fn: () => void,
  time: number
): { cancel: () => void } {
  let cancel: () => void;
  let nextAt: number;
  let timeout: NodeJS.Timeout;
  let wrapper: () => void;
  nextAt = new Date().getTime() + time;
  wrapper = function () {
    nextAt += time;
    timeout = setTimeout(wrapper, nextAt - new Date().getTime());
    return fn();
  };
  cancel = function () {
    return clearTimeout(timeout);
  };
  timeout = setTimeout(wrapper, nextAt - new Date().getTime());
  return {
    cancel: cancel,
  };
};

export const BEEP_SOUND_URL =
  "https://raw.githubusercontent.com/freeCodeCamp/cdn/master/build/testable-projects-fcc/audio/BeepSound.wav";

export const colors = {
  RED: "#ff5252",
  WHITE: "#ffffff",
};
```

## App Class

```typescript
// src/App.tsx

import React from "react";

import { accurateInterval, BEEP_SOUND_URL, colors } from "./lib";
import TimeAdjuster from "./components/TimeAdjuster";
import Clock from "./components/Clock";
import Controls from "./components/Controls";

interface AppProps {}

interface AppState {
  breakLength: number;
  sessionLength: number;
  isCounting: boolean;
  type: string;
  time: number;
  interval: any;
  clockStyle: { color: string };
}

class App extends React.Component<AppProps, AppState> {
  appTitle: string = "PomodoReact";
  audioBeep!: HTMLAudioElement | null;

  constructor(props: AppProps) {
    super(props);
    this.state = {
      breakLength: 5,
      sessionLength: 25,
      isCounting: false,
      type: "Session",
      time: 1500,
      interval: null,
      clockStyle: { color: colors.WHITE },
    };
  }

  updateBreakLength(
    event: React.MouseEvent<HTMLButtonElement, globalThis.MouseEvent>
  ): void {
    this.updateLength(
      "breakLength",
      event.currentTarget.value,
      this.state.breakLength,
      "Break"
    );
  }

  updateSessionLength(
    event: React.MouseEvent<HTMLButtonElement, globalThis.MouseEvent>
  ): void {
    this.updateLength(
      "sessionLength",
      event.currentTarget.value,
      this.state.sessionLength,
      "Session"
    );
  }

  updateLength(
    stateAttribute: string,
    operation: string,
    currentLength: number,
    type: string
  ): void {
    if (this.state.isCounting) return;

    if (operation === "+" && currentLength !== 60) {
      if (this.state.type === type) {
        this.setState({
          ...this.state,
          [stateAttribute]: currentLength + 1,
          time: currentLength * 60 + 60,
        });
      } else {
        this.setState({
          ...this.state,
          [stateAttribute]: currentLength + 1,
        });
      }
    } else if (operation === "-" && currentLength !== 1) {
      if (this.state.type === type) {
        this.setState({
          ...this.state,
          [stateAttribute]: currentLength - 1,
          time: currentLength * 60 - 60,
        });
      } else {
        this.setState({
          ...this.state,
          [stateAttribute]: currentLength - 1,
        });
      }
    }
  }

  handlePlayPause(): void {
    if (!this.state.isCounting) {
      this.countdown();
      this.setState({ isCounting: true });
    } else {
      this.setState({ isCounting: false });
      if (this.state.interval) this.state.interval.cancel();
    }
  }

  decrementCount(): void {
    this.setState({ time: this.state.time - 1 });
  }

  changeColor(time: number): void {
    if (time < 61) {
      this.setState({ clockStyle: { color: colors.RED } });
    } else {
      this.setState({ clockStyle: { color: colors.WHITE } });
    }
  }

  playAudioAlert(time: number): void {
    if (this.audioBeep && time === 0) {
      this.audioBeep.play();
    }
  }

  switchType(newTime: number, newType: string): void {
    this.setState({
      time: newTime,
      type: newType,
      clockStyle: { color: colors.WHITE },
    });
  }

  checkSwitch(): void {
    let { time } = this.state;
    this.changeColor(time);
    this.playAudioAlert(time);
    if (time < 0) {
      if (this.state.interval) this.state.interval.cancel();
      if (this.state.type === "Session") {
        this.countdown();
        this.switchType(this.state.breakLength * 60, "Break");
      } else {
        this.countdown();
        this.switchType(this.state.sessionLength * 60, "Session");
      }
    }
  }

  countdown(): void {
    this.setState({
      interval: accurateInterval(() => {
        this.decrementCount();
        this.checkSwitch();
      }, 1000),
    });
  }

  handleReset(): void {
    this.setState({
      breakLength: 5,
      sessionLength: 25,
      isCounting: false,
      type: "Session",
      time: 1500,
      clockStyle: { color: colors.WHITE },
    });
    if (this.audioBeep) {
      this.audioBeep.pause();
      this.audioBeep.currentTime = 0;
    }
    if (this.state.interval) this.state.interval.cancel();
  }

  render(): JSX.Element {
    const { breakLength, sessionLength, type, time, isCounting } = this.state;

    return (
      <div className="App">
        <h1 className="App-title">
          <i className="fab fa-react"></i> {this.appTitle}
        </h1>

        <div className="settings">
          <TimeAdjuster
            type="Break"
            length={breakLength}
            onChange={(event) => this.updateBreakLength(event)}
          />
          <TimeAdjuster
            type="Session"
            length={sessionLength}
            onChange={(event) => this.updateSessionLength(event)}
          />
        </div>

        <div id="clock-container">
          <Clock type={type} time={time} style={this.state.clockStyle} />

          <Controls
            isCounting={isCounting}
            onPlayPause={() => this.handlePlayPause()}
            onReset={() => this.handleReset()}
          />
        </div>

        <audio
          id="beep"
          preload="auto"
          ref={(audio) => {
            this.audioBeep = audio;
          }}
          src={BEEP_SOUND_URL}
        />
      </div>
    );
  }
}

export default App;
```

## Conclusion

This was a easy and fun project. React is awesome. Actual conclusion text here.
